version: 2

models:  
  - name: base_ga4__events
    description: Base events model that pulls all fields from raw data. Resulting table is partitioned on event_date and is useful in that BQ queries can be cached against this table, but not against wildcard searches from the original tables which are sharded on date. Some light transformation and renaming beyond the base events model. Adds surrogate keys for sessions and events
    columns:
      - name: event_key
        tests:
          - unique
  - name: stg_ga4__event_page_view
    description: GA4 events filtered to only show 'page_view' events. Pivots common event parameters into separate columns. 
  - name: stg_ga4__event_session_start
    description: GA4 events filtered to only show 'session_start' events. Pivots common event parameters into separate columns. 
  - name: stg_ga4__event_purchase
    description: GA4 events filtered to only show 'purchase' events. Pivots common event parameters into separate columns. 
  - name: stg_ga4__users_first_last_pageviews
    description: Captures data related to the first and last page view that each user has completed (by client_id).
    columns:
      - name: client_id
        tests:
          - unique
  - name: stg_ga4__users_first_last_events
    description: Captures the first and last event completed by the user in order to pull in the first and last geo, device, and traffic source seen from the user
    columns:
      - name: client_id
        tests: 
          - unique